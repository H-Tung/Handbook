# 2.3. 安装前的准备工作

一旦确定系统符合安装 FreeBSD 的最低硬件要求，就应该下载安装文件并准备好安装介质。在这之前，请检查系统是否已经准备好进行安装，方法是检查这个表中的项目。

> 
>  **1.备份重要数据**
>
>在安装任何操作系统之前，总是先备份所有的重要数据。不要将备份存储在正在安装的系统上。相反，应将数据保存在可移动磁盘上，如 USB 驱动器，网络上的另一个系统，或在线备份服务。在开始安装前测试备份，以确保它包含所有需要的文件。一旦安装程序格式化了系统的磁盘，存储在该磁盘上的所有数据就会丢失。
>
>**2.决定在哪里安装 FreeBSD**
>
>如果 FreeBSD 是唯一安装的操作系统，这一步就可以跳过。但如果 FreeBSD 将与其他操作系统共享磁盘，请决定哪个磁盘或分区将被用于安装 FreeBSD。
>
>在 i386 和 amd64 架构中，磁盘可以通过两种分区方案之一被划分为多个分区。传统的主引导记录(MBR)拥有一个定义了最多四个主分区的分区表。由于历史原因，FreeBSD 将这些主分区称为片区。这些主分区中的一个可以被制作成包含多个逻辑分区的扩展分区。GUID 分区表（GPT）是一种较新的、较简单的磁盘分区方法。常见的 GPT 实现允许每个磁盘有多达 128 个分区，消除了对逻辑分区的需求。
>
>FreeBSD 启动加载器需要一个主分区或 GPT 分区。如果所有的主分区或 GPT 分区都已经被使用，则必须为 FreeBSD 腾出一个分区。要在不删除现有数据的情况下创建一个分区，可以使用分区调整工具来缩小现有 ? 的分区，并利用释放的空间创建一个新的分区。
>
>各种免费的和商业的分区调整工具列在 http://en.wikipedia.org/wiki/List_of_disk_partitioning_software 。GParted Live (https://gparted.org/livecd.php) 是一张免费的 Live CD，其中包括 GParted 分区编辑器。GParted 也包括在许多其他的 Linux Live CD 发行中。
>
>**注意：如果使用得当，磁盘缩减工具可以安全地创造空间来创建一个新的分区。由于存在选择错误分区的可能性，因此在修改磁盘分区之前，一定要备份任何重要数据，并验证备份的完整性。**
>
>包含不同操作系统的磁盘分区使得在一台计算机上安装多个操作系统成为可能。另一种方法是使用虚拟化（Virtualization），它允许多个操作系统同时运行，而无需修改任何磁盘分区。
>
>**3.收集网络信息**
>
>一些 FreeBSD 安装方法需要网络连接以下载安装文件。在任何安装之后，安装程序都会提出要设置系统的网络接口。
>
>如果网络有 DHCP 服务器，可以用它来提供自动的网络配置。如果 DHCP 不可用，则必须从本地网络管理员或互联网服务提供商那里获得系统的下列网络信息。
>
>所需的网络信息
>>
>>a.IP 地址
>>
>>b.子网掩码
>>
>>c.默认网关的 IP 地址
>>
>>d.网络的域名
>>
>>e.网络的 DNS 服务器的 IP 地址
>
>**4.检查 FreeBSD 的勘误表**
>
>尽管 FreeBSD 项目努力确保每个版本的 FreeBSD 都是尽可能的稳定，但偶尔也会有一些 bug 悄悄发生这个过程。在非常罕见的情况下，这些错误会影响安装过程。当这些问题被发现和修正时， 它们会在 FreeBSD 网站上的 FreeBSD 勘误表 (https://www.freebsd.org/releases/13.0R/errata/) 中注明。在安装前请检查勘误表， 以确保没有可能影响安装的问题。
>
>所有发行版的信息和勘误表可以在 FreeBSD 网站上的发行信息部分找到 (https://www.freebsd.org/releases/)。

## 2.3.1.准备好安装介质

FreeBSD 安装程序不是一个可以从其他操作系统中运行的应用程序。取而代之的是，下载一个 FreeBSD 安装文件，将其刻录到与其文件类型和大小相关的介质上(CD、DVD 或 USB)，然后从插入的介质启动系统进行安装。

FreeBSD的安装文件可以在 www.freebsd.org/where/ 。每个安装文件的名称都包括FreeBSD的发行版本、架构和文件类型。例如，如果要在 amd64 系统上安装 FreeBSD 13.0，请下载 **FreeBSD-13.0-RELEASE-amd64-dvd1.iso**，把这个文件刻录到 DVD 上，然后在插入 DVD 的情况下启动系统。

安装文件有几种格式。这些格式因计算机结构和媒体类型而异。

对于使用 UEFI（统一可扩展固件接口）启动的计算机，还包括其他安装文件。这些文件的名称包括**uefi**这个字符串。。

文件类型。

- -bootonly.iso。这是最小的安装文件，因为它只包含安装程序。在安装过程中需要一个正常的互联网连接，因为安装程序会下载完成 FreeBSD 安装所需的文件。这个文件应该用光盘刻录软件刻录到光盘上。

- -disc1.iso。这个文件包含了安装 FreeBSD 所需的所有文件， 它的源代码，以及 Ports Collection。应使用光盘刻录软件将其刻录到光盘上。

- -dvd1.iso。这个文件包含了安装 FreeBSD、其源代码和 Ports Collection 所需的所有文件。它还包含了一套用于安装窗口管理器和一些应用程序的常用二进制包， 这样就可以从媒体上安装一个完整的系统， 而不需要连接到互联网。这个文件应该用 DVD 刻录程序刻录到DVD上。

- -memstick.img: 这个文件包含了安装 FreeBSD 所需的所有文件， 以及它的源代码和 Ports Collection。应该按照下面的说明把它刻录到U盘上。

- -mini-memstick.img。和 -bootonly.iso 一样，不包括安装文件，但会根据需要下载它们。在安装过程中需要一个工作的互联网连接。将此文件写入U盘，如写入映像文件到U盘中所示。

下载镜像文件后，从同一目录中下载 **CHECKSUM.SHA256**。计算映像文件的校验和。FreeBSD 为此提供了 sha256(1) ，作为`sha256 镜像文件名`使用。其他操作系统也有类似的程序。

将计算出来的校验和与**CHECKSUM.SHA256**中显示的校验和进行比较。这些校验和必须完全匹配。如果校验和不匹配，图像文件就会损坏，必须重新下载。

### 2.3.1.1.将镜像写入 USB 设备

**\*.img** 文件是一个U盘完整的镜像。它不能作为一个文件被复制到目标设备上。有几个应用程序可用于将 **\*.img** 写入U盘。本节介绍其中的两个软件。

#### 重点：在继续进行之前，请备份U盘上的任何重要数据。这个程序将删除 U 盘上的现有数据。

>使用 dd 刻录镜像
>
>**警告：这个例子使用 `/dev/da0` 作为目标设备，镜像将被写入该设备。要非常小心使用正确的设备，因为这个命令会破坏指定的目标设备上的现有数据。**
>这个命令行工具在 BSD、Linux® 和 Mac OS® 系统上可用。要使用 dd 刻录镜像，插入 U 盘并确定其设备名称。然后，指定下载的安装文件的名称和 U 盘的设备名称。这个例子将 amd64 安装镜像刻录到现有 FreeBSD 系统的第一个 USB 设备上。
>```
># dd if=FreeBSD-13.0-RELEASE-amd64-memstick.img of=/dev/da0 bs=1M conv=sync
>```
>如果这个命令失败了，请确认 U 盘没有被挂载，而且设备名称是磁盘的名称，而不是一个分区。一些操作系统可能要求这个命令必须在 sudo(8)下运行。dd(1)的语法在不同的平台上略有不同；例如，Mac OS® 需要小写的 bs=1m。像 Linux® 这样的系统可能会对写入进行缓冲。要强制所有的写操作完成，请使用 sync(8)。

>使用 Windows® 刻录镜像
>
>**警告：请确保给出正确的盘符，因为指定驱动器上的现有数据将被覆盖和销毁。**
>
>**1、获得用于Windows® 的 Image Writer**
>
>Image Writer for Windows® 是一个免费的应用程序，可以正确地将镜像文件写入存储器。从https://sourceforge.net/projects/win32diskimager/ ，并将其解压到一个文件夹中。
>
>**2、用 Image Writer 写入镜像**
>
>双击 Win32DiskImager 图标以启动该程序。确认 "设备"下显示的盘符是装有 USB 设备的驱动器。点击文件夹图标，选择要写入 U 盘的镜像。点击 "保存"，接受图像文件名。确认一切都正确，并且 U 盘>的文件夹没有在其他窗口中打开。一切准备就绪后，点击写入，将镜像文件写入存储器。

现在你已经准备好，可以开始安装FreeBSD了。
