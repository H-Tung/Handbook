# 11.5. 配置 WINE 安装

在了解了WINE是什么以及它如何在高层次上工作之后，在FreeBSD上有效使用它的下一步就是熟悉它的配置。下面几节将描述WINE前缀的关键概念，并说明如何用它来控制通过WINE运行的应用程序的行为。

## 11.5.1.  WINE 前缀
WINE 前缀是一个目录，通常位于 **$HOME/.wine** 的默认位置之下，尽管它可以位于其他地方。前缀是一组配置和支持文件，由wine用来配置和运行特定应用程序所需的 Windows® 环境。默认情况下，一个全新的WINE安装在用户首次启动时将创建以下结构。

- **.update-timestamp** ：包含文件 **/usr/share/wine/wine.inf** 的最后修改日期。它被 WINE 用来判断一个前缀是否过时，并在需要时自动更新它。

- **dosdevices/** : 包含 Windows® 资源与主机FreeBSD系统上的资源的映射信息。例如，在新的WINE安装之后，这里应该至少包含两个条目，可以使用Windows®风格的驱动器字母来访问FreeBSD的文件系统。

    - **c:@** : 与下面描述的 **drive_c** 的链接。

    - **z:@** : 到系统根目录的链接。

- **drive_c/** : 模拟Windows®系统的主驱动器（即 **C：** ）。它包含一个目录结构和相关文件，与标准的 Windows® 系统一样。一个新的 WINE 前缀将包含 Windows® 10 目录，如 Users 和 Windows ，其中包含操作系统本身。此外，安装在前缀中的应用程序将位于 Program Files 或 Program Files (x86) 中，这取决于其架构。

- **system.reg** ：这个注册表文件包含了 Windows® 安装的信息，在 WINE 的情况下，它是 **drive_c** 中的环境。

- **user.reg** : 这个注册表文件包含了当前用户的个人配置，由各种软件或通过使用注册表编辑器来完成。

- **userdef.reg** : 这个注册表文件是新创建的用户的默认配置集。

## 11.5.2. 创建和使用WINE前缀
虽然 WINE 会在用户的 **$HOME/.wine/** 中创建一个默认前缀，但也可以设置多个前缀。这样做有几个原因。

- 最常见的原因是根据有关软件的兼容性需要，模拟不同版本的 Windows® 。

- 此外，经常会遇到一些在默认环境下不能正常工作的软件，需要进行特殊的配置。将这些软件隔离在自己的自定义前缀中是很有用的，这样的改变不会影响其他应用程序。

- 同样，为了评估一个应用程序的兼容性，将默认或 " main "前缀复制到一个单独的 " testing "前缀中，可以减少错误的机会。

从终端创建一个前缀需要使用以下命令。
```
% WINEPREFIX="/home/username/.win-new" winecfg
```
这将运行 winecfg 程序，该程序可用于配置 WINE 前缀（在后面的章节中会有更多介绍）。但通过为 WINEPREFIX 环境变量提供一个目录路径值，如果一个前缀还不存在，就会在该位置创建一个新的前缀。

向wine程序提供同样的变量，同样会导致所选程序以指定的前缀运行。
```
% WINEPREFIX="/home/username/.win-new" wine program.exe
```
## 11.5.3. 用winecfg配置WINE前缀
如上所述，WINE包括一个名为 winecfg 的工具，可以在图形用户界面中配置前缀。它包含各种功能，在下面的章节中会详细介绍。当 winecfg 从一个前缀中运行时，或者在 `WINEPREFIX` 变量中提供一个前缀的位置时，它就可以对所选的前缀进行配置，如以下各节所述。

在 "应用程序 "选项卡上进行的选择将影响在 " *Libraries* "和 " *Graphics* "选项卡上的更改范围，这些更改将被限制在所选的应用程序中。更多细节请参见 WINE Wiki 中关于使用 Winecfg 的部分。

### 11.5.3.1. 应用程序
【——————————-此处需要插入图片­——————————————-】
 *Applications* 包含了使程序与特定版本的 Windows® 相关联的控制。第一次启动时，应用程序设置部分将包含一个条目。默认设置。这相当于前缀的所有默认配置，（正如禁用的删除应用程序按钮所暗示的）不能被删除。

但可以通过以下过程添加额外的应用程序。

1. 单击 " *Add application* "按钮。

2. 使用提供的对话框选择所需的程序的可执行文件。

3. 选择要与所选程序一起使用的 Windows® 版本。

### 11.5.3.2. 库
【——————————-此处需要插入图片­——————————————-】
WINE 提供了一组开源的库文件作为其发行的一部分，这些库文件提供了与 Windows® 对应的相同功能。然而，正如本章前面所提到的， WINE 项目一直在努力跟上这些库的新更新。因此，与 WINE 一起发行的版本可能缺少最新 Windows® 程序所期望的功能。

然而，winecfg 可以为内置的库指定重写，特别是在安装FreeBSD的同一台机器上有Windows®的版本。对于每一个要被覆盖的库，请执行以下操作。

打开 New override for library 下拉菜单，选择要替换的库。

点击添加按钮。

新的覆盖将出现在现有覆盖列表中，注意括号中的本地、内置指定。

点击选择该库。

点击 "编辑 "按钮。

使用提供的对话框选择一个相应的库来代替内置库。

请确保选择一个真正与内置库对应的文件，否则可能会有意想不到的行为。