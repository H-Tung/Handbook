# 3.3.用户和基本账户管理

FreeBSD允许多个用户同时使用计算机。虽然在任何时候只有一个用户可以坐在屏幕前使用键盘，但任何数量的用户都可以通过网络登录到系统中。为了使用该系统，每个用户都应该有自己的用户账户。

本章介绍：

- FreeBSD系统中不同类型的用户帐号。

- 如何添加，删除，和修改用户账户。

- 如何设置限制来控制允许用户和群组访问的资源。

- 如何创建组并将用户添加为组的成员。

## 3.3.1.账户类型

由于对 FreeBSD 系统的所有访问都是通过帐户实现的，而且所有进程都是由用户运行的，因此用户和帐户的管理非常重要。

主要有三种类型的账户：系统账户、用户账户和超级用户账户。

### 3.3.1.1.系统账户

系统账户用于运行服务，如 DNS、邮件和网络服务器。这样做的原因是安全问题；如果所有的服务都以超级用户的身份运行，它们就可以不受限制地行动。

系统账户的例子有`daemon、operator、bind、news、www`。

在使用`operator`组时必须小心，因为可能会被授予类似超级用户的访问权限，包括但不限于关机、重启和访问该组中`/dev`中的所有项目。

`nobody`是通用的无特权系统账户。然而，使用`nobody`的服务越多，该用户将与更多的文件和进程相关联，因此该用户的特权就越大。

### 3.3.1.2.用户账户

用户账户被分配给真实的人，用来登录和使用系统。每个访问系统的人都应该有一个独特的用户账户。这使管理员能够发现谁在做什么，并防止用户篡改其他用户的设置。

每个用户都可以通过配置默认的shell、编辑器、密钥绑定和语言设置来设置自己的环境，以适应他们对系统的使用。

在FreeBSD系统上的每个用户账户都有一些相关的信息。

***User name***
用户名称是在login: 提示符下输入的。每个用户都必须有一个唯一的用户名。在passwd(5)中记录了一些创建有效用户名的规则。建议使用由八个或更少的小写字母组成的用户名，以保持与应用程序的向后兼容性。

***Password***
每个账户都有一个相关的密码。

***User ID (UID)***
用户ID(UID)是一个数字，用于在FreeBSD系统中唯一地识别用户。允许指定用户名的命令将首先把它转换为UID。建议使用小于65535的UID，因为更高的值可能会引起某些软件的兼容性问题。

***Group ID (GID)***
组ID（GID）是一个数字，用于唯一地识别用户所属的主组。组是一种机制，根据用户的GID而不是UID来控制对资源的访问。这可以大大减少一些配置文件的大小，并允许用户成为一个以上的组的成员。建议使用65535或更低的GID，因为更高的GID可能会破坏一些软件。

***Login class***
登录类是对组机制的扩展，在为不同用户定制系统时提供了额外的灵活性。登录类别在配置登录类别中进一步讨论。

***Password change time***
默认情况下，密码是不会过期的。然而，可以在每个用户的基础上启用密码过期，迫使部分或所有用户在一定时间后改变他们的密码。

***Account expiration time***
默认情况下， FreeBSD 不对账户进行过期保护。当创建需要有限寿命的账户时， 例如学校的学生账户， 可以使用 pw(8) 指定账户的过期时间。在过期时间过后，这个账户就不能用来登录系统了，不过这个账户的目录和文件会保留。

***User’s full name***
用户名称对 FreeBSD 来说是账户的唯一标识， 但不一定反映用户的真实姓名。与注释类似，这一信息可以包含空格、大写字母，并且长度超过8个字符。

***Home directory***
主目录是系统中一个目录的完整路径。当用户登录时，这是用户的起始目录。一个常见的惯例是把所有用户的主目录放在 /home/username 或 /usr/home/username 下。每个用户都把他们的个人文件和子目录存放在自己的主目录下。

***User shell***
shell为用户提供了与系统交互的默认环境。有许多不同种类的shell，有经验的用户会有自己的偏好，这些偏好可以反映在他们的帐户设置中。

### 3.3.1.3.超级用户账户 

超级用户账户，通常称为 root，用于管理系统，没有权限限制。由于这个原因，它不应该被用于日常工作，如发送和接收邮件，对系统的一般探索，或编程。

超级用户与其他用户账户不同，可以不受限制地操作，滥用超级用户账户可能导致壮观的灾难。用户账户无法错误地破坏操作系统，因此建议以用户账户登录，只有在命令需要额外权限时才成为超级用户。

对于以超级用户身份发布的任何命令，一定要进行双重和三重检查，因为一个额外的空格或缺失的字符可能意味着不可修复的数据损失。

有几种方法可以获得超级用户的权限。虽然人们可以以 root 身份登录，但这是非常不可取的。

相反，使用 su(1)来成为超级用户。如果在运行这个命令时指定了"-"，用户也将继承根用户的环境。运行该命令的用户必须在`wheel`组中，否则命令会失败。该用户还必须知道根用户账户的密码。

在这个例子中，用户只有成为超级用户才能运行`make install`，因为这个步骤需要超级用户的权限。命令完成后，用户输入`exit`，离开超级用户账户，返回到用户账户的权限。

>例1. 以超级用户身份安装一个程序
>```
>% configure
>% make
>% su -
>Password:
># make install
># exit
>%
>```

内置的 su(1)框架对于只有一个系统管理员的单一系统或小型网络来说效果很好。另一个选择是安装`security/sudo`软件包或端口。这个软件提供活动记录，并允许管理员配置哪些用户可以作为超级用户运行哪些命令。

## 3.3.2.管理账户

FreeBSD 提供了各种不同的命令来管理用户账户。最常见的命令在《管理用户帐户的实用工具》中进行了总结，后面还有一些使用实例。关于更多的细节和使用例子，请参见每个工具的手册页面。

表1. 管理用户账户的实用工具
|命令|概述|
|:---:|:---:|
|adduser(8)|推荐用于添加新用户的命令行程序。|
|rmuser(8)|推荐用于删除用户的命令行程序。|
|chpass(1)|	一个灵活的，用于改变用户数据库信息的工具。|
|passwd(1)|用于更改用户密码的命令行工具。|
|pw(8)|一个强大而灵活的工具，用于修改用户账户的所有方面。|

### 3.3.2.1. adduser

